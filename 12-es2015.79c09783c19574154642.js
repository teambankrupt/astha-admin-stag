(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{PDDa:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var o=i("8Y7J"),n=i("8yjs"),a=i("mb36"),r=i("EApP"),s=i("IheW"),c=i("iInd"),l=i("lX9O");let u=(()=>{class e{constructor(e,t,i,o,n,a){this.apiEndPointsService=e,this.baseService=t,this.toastr=i,this.http=o,this.router=n,this.authService=a}get_location_types(e,t){return this.http.get(this.apiEndPointsService.LOCATIONS_TYPES.FETCH(e,t)+"&access_token="+this.authService.getAccessToken())}search_location_types(e){return this.http.get(this.apiEndPointsService.LOCATIONS_TYPES.SEARCH(e)+"&access_token="+this.authService.getAccessToken())}remove_location_types(e){return this.http.delete(this.apiEndPointsService.LOCATIONS_TYPES.DELETE(e)+"?access_token="+this.authService.getAccessToken())}}return e.\u0275fac=function(t){return new(t||e)(o.ac(n.a),o.ac(a.a),o.ac(r.b),o.ac(s.a),o.ac(c.f),o.ac(l.a))},e.\u0275prov=o.Ib({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},flBB:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var o=i("8Y7J"),n=i("8yjs"),a=i("lX9O"),r=i("IheW");let s=(()=>{class e{constructor(e,t,i){this.apiEndpoints=e,this.authService=t,this.http=i}uploadImage(e){const t=new FormData;for(let o=0;o<e.length;o++)t.append("files",e[o]);let i=this.apiEndpoints.IMAGE.UPLOAD()+this.authService.getAccessToken();return this.http.post(i,t)}}return e.\u0275fac=function(t){return new(t||e)(o.ac(n.a),o.ac(a.a),o.ac(r.a))},e.\u0275prov=o.Ib({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},qof1:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var o=i("8Y7J"),n=i("8yjs"),a=i("mb36"),r=i("EApP"),s=i("IheW"),c=i("iInd"),l=i("lX9O");let u=(()=>{class e{constructor(e,t,i,o,n,a){this.apiEndPointsService=e,this.baseService=t,this.toastr=i,this.http=o,this.router=n,this.authService=a}get_location_list(e,t,i,o){return this.http.get(this.apiEndPointsService.LOCATIONS.FETCH(e,t,i,o)+"&access_token="+this.authService.getAccessToken())}get_location(e,t,i,o){return this.http.get(this.apiEndPointsService.LOCATIONS.FETCH_BY_TYPE_ID(e,t,i,o)+"&access_token="+this.authService.getAccessToken())}search_location(e,t){return this.http.get(this.apiEndPointsService.LOCATIONS.SEARCH(e,t)+"&access_token="+this.authService.getAccessToken())}remove_location(e){return this.http.delete(this.apiEndPointsService.LOCATIONS.DELETE(e)+"?access_token="+this.authService.getAccessToken())}}return e.\u0275fac=function(t){return new(t||e)(o.ac(n.a),o.ac(a.a),o.ac(r.b),o.ac(s.a),o.ac(c.f),o.ac(l.a))},e.\u0275prov=o.Ib({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},tpXV:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var o=i("s7LF"),n=i("8Y7J"),a=i("8yjs"),r=i("mb36"),s=i("EApP"),c=i("IheW"),l=i("iInd"),u=i("lX9O");let d=(()=>{class e{constructor(e,t,i,o,n,a,r){this.apiEndPointsService=e,this.baseService=t,this.toastr=i,this.http=o,this.router=n,this.authService=a,this.formBuilder=r}initializeLocationTypeForm(){return this.formBuilder.group({label:new o.e(null,[o.v.required]),description:new o.e(null,[o.v.required]),code:new o.e(null,[o.v.required]),level:new o.e(null,[o.v.required]),parent_id:new o.e(null)})}populateForm(e){return this.formBuilder.group({id:new o.e(null==e?void 0:e.id),label:new o.e(null==e?void 0:e.label),level:new o.e(null==e?void 0:e.level),description:new o.e(null==e?void 0:e.description),code:new o.e(null==e?void 0:e.code),parent_id:new o.e(null==e?void 0:e.parent_id)})}create_location_types(e){return this.http.post(this.apiEndPointsService.LOCATIONS_TYPES.CREATE()+"?access_token="+this.authService.getAccessToken(),e)}location_type_details(e){return console.log(e),this.http.get(this.apiEndPointsService.LOCATIONS_TYPES.DETAILS(e)+"?access_token="+this.authService.getAccessToken())}update_location_type(e,t){return this.http.patch(this.apiEndPointsService.LOCATIONS_TYPES.UPDATE(e)+"?access_token="+this.authService.getAccessToken(),t)}}return e.\u0275fac=function(t){return new(t||e)(n.ac(a.a),n.ac(r.a),n.ac(s.b),n.ac(c.a),n.ac(l.f),n.ac(u.a),n.ac(o.d))},e.\u0275prov=n.Ib({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},uB8i:function(e,t,i){"use strict";i.d(t,"a",(function(){return y}));var o=i("8Y7J"),n=i("iInd"),a=i("s7LF"),r=i("8yjs"),s=i("mb36"),c=i("EApP"),l=i("IheW"),u=i("lX9O");let d=(()=>{class e{constructor(e,t,i,o,n,a,r){this.apiEndPointsService=e,this.baseService=t,this.toastr=i,this.http=o,this.router=n,this.authService=a,this.formBuilder=r}initializeLocationForm(){return this.formBuilder.group({label:new a.e(null,[a.v.required]),code:new a.e(null,[a.v.required]),type_id:new a.e(null,[a.v.required]),altitude:new a.e(null,[a.v.required]),latitude:new a.e(null,[a.v.required]),longitude:new a.e(null,[a.v.required]),parent_id:new a.e(null),description:new a.e(null),image:new a.e(null)})}populateForm(e){return this.formBuilder.group({id:new a.e(null==e?void 0:e.id),label:new a.e(null==e?void 0:e.label),description:new a.e(null==e?void 0:e.description),code:new a.e(null==e?void 0:e.code),type_id:new a.e(null==e?void 0:e.type_id),altitude:new a.e(null==e?void 0:e.altitude),latitude:new a.e(null==e?void 0:e.latitude),longitude:new a.e(null==e?void 0:e.longitude),parent_id:new a.e(null==e?void 0:e.parent_id),image:new a.e(null==e?void 0:e.image)})}create_location(e){return this.http.post(this.apiEndPointsService.LOCATIONS.CREATE()+"?access_token="+this.authService.getAccessToken(),e)}location_details(e){return this.http.get(this.apiEndPointsService.LOCATIONS.DETAILS(e)+"?access_token="+this.authService.getAccessToken())}update_location(e,t){return this.http.patch(this.apiEndPointsService.LOCATIONS.UPDATE(e)+"?access_token="+this.authService.getAccessToken(),t)}}return e.\u0275fac=function(t){return new(t||e)(o.ac(r.a),o.ac(s.a),o.ac(c.b),o.ac(l.a),o.ac(n.f),o.ac(u.a),o.ac(a.d))},e.\u0275prov=o.Ib({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var h=i("PDDa"),p=i("qof1"),b=i("tpXV"),v=i("flBB"),S=i("wTG2"),g=i("SVse");function m(e,t){if(1&e&&(o.Sb(0,"div"),o.Nb(1,"img",33),o.Rb()),2&e){const e=o.hc();o.zb(1),o.mc("src",e.imageUrl,o.Bc)}}const f=function(){return{standalone:!0}};let y=(()=>{class e{constructor(e,t,i,o,n,a,r,s,c){this.activatedRoute=e,this.createLocationService=t,this.toastService=i,this.router=o,this.baseService=n,this.listOfTypesService=a,this.locationsService=r,this.createTypesService=s,this.fileUploadService=c,this.paramId=null,this.buttonStatus="Create Child",this.loctype=null,this.loc=null,this.global_type_id=null,this.isParentDisable=!1,this.isLocationTypeDisable=!1}ngOnInit(){this.paramId=this.activatedRoute.snapshot.paramMap.get("id"),this.registerLocationForm=this.createLocationService.initializeLocationForm(),this.router.url.split("/").includes("location-types")?this.onLocationCreateFromLocationType():(this.listOfTypesService.get_location_types(0,100).subscribe(e=>{this.location_types=e.content}),this.paramId&&"add"!=this.router.url.split("/").pop()?(this.buttonStatus="Update",this.createLocationService.location_details(this.paramId).subscribe(e=>{this.registerLocationForm=this.createLocationService.populateForm(e),this.getLocationTypeById(this.registerLocationForm.value.type_id),e.parent_id&&(this.loc=e.parent_id),this.imageUrl=null==e?void 0:e.image,this.selectedimage=null==e?void 0:e.image})):(this.buttonStatus="Create",this.isParentDisable=!0))}getLocationTypeById(e){this.createTypesService.location_type_details(e).subscribe(e=>{var t;this.loctype=e,this.global_type_id=this.loctype.parent_id,(null===(t=this.loctype)||void 0===t?void 0:t.parent_id)&&this.getLocation(this.loctype.parent_id)})}onLocationCreateFromLocationType(){this.buttonStatus="Create",this.registerLocationForm.get("type_id").setValue(Number(this.paramId)),this.getLocationTypeById(Number(this.paramId)),this.listOfTypesService.get_location_types(0,1e3).subscribe(e=>{this.location_types=e.content,this.isLocationTypeDisable=!0})}getLocation(e){this.locationsService.get_location(0,1e3,e).subscribe(e=>{this.locations=e.content})}searchLocationType(e){""!=e?this.listOfTypesService.search_location_types(e).subscribe(e=>{this.location_types=e.content}):this.listOfTypesService.get_location_types(0,1e3).subscribe(e=>{this.location_types=e.content})}onChangeLocationType(){this.locations=null,"Create"==this.buttonStatus&&null!=this.loctype?(this.registerLocationForm.get("type_id").setValue(this.loctype.id),this.isParentDisable=!1,this.global_type_id=this.loctype.parent_id,this.getLocation(this.loctype.parent_id)):(this.global_type_id=null,this.isParentDisable=!0,this.loc=null,this.registerLocationForm.get("type_id").setValue(null),this.registerLocationForm.get("parent_id").setValue(null))}onSearchLocation(e){""!=e?this.locationsService.search_location(e,this.global_type_id).subscribe(e=>{this.locations=e.content}):this.getLocation(this.global_type_id)}onImageChanged(e){if(this.selectedimage=e.target.files[0],e.target.files&&e.target.files[0]){if(e.target.files[0].size>=5e6)return this.selectedimage=null,void window.alert("Image size must be less than 5MB");this.fileUploadService.uploadImage(e.target.files).subscribe(e=>{this.assignImage(e)},e=>{this.toastService.error("Image upload failed, please try again later")});let t=e.target.files.length;for(let i=0;i<t;i++){let t=new FileReader;t.onload=e=>{this.imageUrl=e.target.result},t.readAsDataURL(e.target.files[i])}}}assignImage(e){let t;for(let i=0;i<e.length;i++)t=e[i].thumb_url;this.registerLocationForm.controls.image.setValue(t)}onCheckValidation(){return null==this.loctype.parent_id||null!=this.loc||(this.toastService.warning("You must select a parent","Warning!"),!1)}createLocation(){this.onCheckValidation()&&("Create"==this.buttonStatus?this.createLocationService.create_location(this.registerLocationForm.value).subscribe(e=>{this.toastService.success("Locations Created Successfully"),this.router.navigate(["locations"])}):this.createLocationService.update_location(this.paramId,this.registerLocationForm.value).subscribe(e=>{this.toastService.success("Locations Updated Successfully"),this.router.navigate(["locations"])}))}}return e.\u0275fac=function(t){return new(t||e)(o.Mb(n.a),o.Mb(d),o.Mb(c.b),o.Mb(n.f),o.Mb(s.a),o.Mb(h.a),o.Mb(p.a),o.Mb(b.a),o.Mb(v.a))},e.\u0275cmp=o.Gb({type:e,selectors:[["app-create-location"]],decls:82,vars:14,consts:[[1,"row"],[1,"col-12","grid-margin","stretch-card"],[1,"card"],[1,"card-body"],[1,"card-title"],[1,"forms-sample",3,"formGroup"],[1,"col-md-6"],[1,"form-group"],["for","Title"],["type","text","id","Title","placeholder","Title","formControlName","label",1,"form-control"],["for","Code"],["type","text","id","Code","placeholder","Code","formControlName","code",1,"form-control"],[1,"label-text"],["bindLabel","label","placeholder","Search Country",3,"items","virtualScroll","readonly","ngModel","ngModelOptions","keyup","ngModelChange","change"],["bindLabel","label","bindValue","id","placeholder","Search Location","formControlName","parent_id",3,"items","readonly","ngModel","keyup","ngModelChange"],["for","exampleTextarea1"],["formControlName","description","id","exampleTextarea1","rows","3","placeholder","Description",1,"form-control"],["type","file","name","img",1,"file-upload-default"],[1,"input-group","col-xs-12"],["type","file",1,"form-control","file-upload-info",3,"change"],["fileInput",""],[1,"input-group-append"],["type","button",1,"file-upload-browse","btn","btn-gradient-primary",3,"click"],[4,"ngIf"],[1,"col-md-4"],["type","number","id","altitude","placeholder","Altitude","formControlName","altitude","min","0",1,"form-control"],["type","number","id","latitude","placeholder","Latitude","formControlName","latitude","min","0",1,"form-control"],["type","number","id","longitude","placeholder","Longitude","formControlName","longitude","min","0",1,"form-control"],[1,"modal-footer"],["type","button",1,"btn","btn-gradient-success","btn-icon-text",3,"disabled","click"],[1,"mdi","mdi-file-check","btn-icon-prepend"],["type","button","routerLink","/locations",1,"btn","btn-gradient-danger","btn-icon-text"],[1,"mdi","mdi-close","btn-icon-prepend"],["alt","","width","100",1,"imageClass",3,"src"]],template:function(e,t){if(1&e){const e=o.Tb();o.Sb(0,"div",0),o.Sb(1,"div",1),o.Sb(2,"div",2),o.Sb(3,"div",3),o.Sb(4,"h4",4),o.Lc(5),o.Rb(),o.Sb(6,"form",5),o.Sb(7,"div",0),o.Sb(8,"div",6),o.Sb(9,"div",7),o.Sb(10,"label",8),o.Sb(11,"sup"),o.Lc(12,"*"),o.Rb(),o.Lc(13,"Label"),o.Rb(),o.Nb(14,"input",9),o.Rb(),o.Rb(),o.Sb(15,"div",6),o.Sb(16,"div",7),o.Sb(17,"label",10),o.Sb(18,"sup"),o.Lc(19,"*"),o.Rb(),o.Lc(20,"Code"),o.Rb(),o.Nb(21,"input",11),o.Rb(),o.Rb(),o.Rb(),o.Sb(22,"div",0),o.Sb(23,"div",6),o.Sb(24,"div",7),o.Sb(25,"label",12),o.Sb(26,"sup"),o.Lc(27,"*"),o.Rb(),o.Lc(28,"Type"),o.Rb(),o.Sb(29,"ng-select",13),o.dc("keyup",(function(e){return t.searchLocationType(e.target.value)}))("ngModelChange",(function(e){return t.loctype=e}))("change",(function(){return t.onChangeLocationType()})),o.Rb(),o.Rb(),o.Rb(),o.Sb(30,"div",6),o.Sb(31,"div",7),o.Sb(32,"label",12),o.Lc(33,"Parent"),o.Rb(),o.Sb(34,"ng-select",14),o.dc("keyup",(function(e){return t.onSearchLocation(e.target.value)}))("ngModelChange",(function(e){return t.loc=e})),o.Rb(),o.Rb(),o.Rb(),o.Rb(),o.Sb(35,"div",0),o.Sb(36,"div",6),o.Sb(37,"div",7),o.Sb(38,"label",15),o.Lc(39,"Description"),o.Rb(),o.Nb(40,"textarea",16),o.Rb(),o.Rb(),o.Sb(41,"div",6),o.Sb(42,"div",7),o.Sb(43,"label"),o.Lc(44,"Image"),o.Rb(),o.Nb(45,"input",17),o.Sb(46,"div",18),o.Sb(47,"input",19,20),o.dc("change",(function(e){return t.onImageChanged(e)})),o.Rb(),o.Sb(49,"span",21),o.Sb(50,"button",22),o.dc("click",(function(){return o.zc(e),o.wc(48).click()})),o.Lc(51,"Upload"),o.Rb(),o.Rb(),o.Rb(),o.Rb(),o.Jc(52,m,2,1,"div",23),o.Rb(),o.Rb(),o.Sb(53,"div",0),o.Sb(54,"div",24),o.Sb(55,"div",7),o.Sb(56,"label"),o.Sb(57,"sup"),o.Lc(58,"*"),o.Rb(),o.Lc(59,"altitude"),o.Rb(),o.Nb(60,"input",25),o.Rb(),o.Rb(),o.Sb(61,"div",24),o.Sb(62,"div",7),o.Sb(63,"label"),o.Sb(64,"sup"),o.Lc(65,"*"),o.Rb(),o.Lc(66,"latitude"),o.Rb(),o.Nb(67,"input",26),o.Rb(),o.Rb(),o.Sb(68,"div",24),o.Sb(69,"div",7),o.Sb(70,"label"),o.Sb(71,"sup"),o.Lc(72,"*"),o.Rb(),o.Lc(73,"longitude"),o.Rb(),o.Nb(74,"input",27),o.Rb(),o.Rb(),o.Rb(),o.Sb(75,"div",28),o.Sb(76,"button",29),o.dc("click",(function(){return t.createLocation()})),o.Nb(77,"i",30),o.Lc(78),o.Rb(),o.Sb(79,"button",31),o.Nb(80,"i",32),o.Lc(81," Cancel "),o.Rb(),o.Rb(),o.Rb(),o.Rb(),o.Rb(),o.Rb(),o.Rb()}2&e&&(o.zb(5),o.Nc("",t.buttonStatus," Location"),o.zb(1),o.mc("formGroup",t.registerLocationForm),o.zb(23),o.mc("items",t.location_types)("virtualScroll",!0)("readonly",t.isLocationTypeDisable)("ngModel",t.loctype)("ngModelOptions",o.pc(13,f)),o.zb(5),o.mc("items",t.locations)("readonly",t.isParentDisable)("ngModel",t.loc),o.zb(18),o.mc("ngIf",null!=t.imageUrl),o.zb(24),o.mc("disabled",!t.registerLocationForm.valid),o.zb(2),o.Nc(" ",t.buttonStatus," "))},directives:[a.x,a.o,a.h,a.c,a.n,a.f,S.a,a.q,g.m,a.s,n.g],styles:[".modal-footer[_ngcontent-%COMP%]{border-top:none}.card-title[_ngcontent-%COMP%]{margin-bottom:1.75rem}sup[_ngcontent-%COMP%]{color:red}"]}),e})()}}]);